var inputText = "";
var outputText = "";


var samples = {};
samples.kampf       = {active:false, name:"Mein Kampf",              text:"Here he is not frightened by anything at all, and his base-ness becomes so gigantic that nobody need wonder that in our people the personification of the Devil, as the symbol of all evil, assumes the living appearance of the Jew. The ignorance of the great masses about the inner nature of the Jew, the lack of instinct and narrow-mindedness of our upper classes, make the people easily fall victim to this Jewish campaign of lies. While the upper classes, out of their inborn cowardice, turn from a man who is attacked by the Jew in such manner with lie and calumny, the great masses, out of stupidity or simplicity, usually believe everything. But the State authorities either wrap themselves in silence, or, as is mostly the case, they persecute him who is unjustly attacked, in order to make an end to the nuisance of the Jewish press, something which then, in the eyes of such an official idiot, appears as the preservation of State authority and as safeguarding peace and order, t Slowly the fear of the Marxist weapon of Jewry sinks into the brains and souls of decent people like a nightmare. One begins to tremble before the terrible enemy, and thus one has become his final victim. The Jew's rule in the State now appears secured to such an extent that he may not only again call himself Jew, but ruthlessly admits his final thoughts as regards nationality and politics. A part of his race even admits quite openly that it is a foreign people, however, not without again lying in this respect. For while Zionism tries to make the other part of the world believe that the national self-consciousness of the Jew finds satisfaction in the creation of a Palestinian State, the Jews again most slyly dupe the stupid goiim. [Jewish colloquial expression : Gentile men or women.] They have no thought of building up a Jewish State in Palestine, so that they might perhaps inhabit it, but they only want a central organization of their international world cheating, endowed with prerogatives, withdrawn from the seizure of others: a refuge for convicted rascals and a high school for future rogues. But it is the sign, not only of their rising confidence, but also their feeling of safety, that now, at a time when one part of them still mendaciously plays the German, the Frenchman, or the Englishman, the other part impudently and openly documents itself as the Jewish race. How far they keep the approaching victory before their eyes is seen from the terrible manner which their intercourse with the members of other peoples assumes. For hours the black-haired Jew boy, diabolic joy in his face, waits in ambush for the unsuspecting girl whom he defiles with his blood and thus robs her from her people. With the aid of all means he tries to ruin the racial foundations of the people to be enslaved. Exactly as he himself systematically demoralizes women and girls, he is not scared from pulling down the barriers of blood and race for others on a large scale. It was and is the Jews who bring the negro to the Rhine, always with the same concealed."};
samples.mathematica = {active:false, name:"Newton's Mathematica",    text:"If a cylinder moves uninformly forward in a compressed, infinite, arid non-elastic finid, in the direction of its length, the resistance arising from the magnitude of its transverse section is to the force by which its whole motion may be destroyed or generated, in the time that it moves four times its length, as the density of the medium to the den sity of the cylinder, nearly. For let the vessel ABDC touch the surface of stagnant water with its bottom CD, and let the water run out of this vessel into the stagnant wa ter through the cylindric canal EFTS perpendicular co the horizon ; and let the little circle PQ, be placed parallel to the horizon any where in the middle of the canal; and produce CA to K, sothat AK may be to CK in the duplicate of the ratio, which the excess of the orifice of the canal EF above the little circle PQ bears to the cir cle AB. Then it is manifest (by Case 5, Case 6, and Cor. 1, Prop. XXXVI) that the velocity of the water passing through the annular space between the little circle and the sides of the ves sel will be the very same which the water would acquire by falling, and in its fall describing the altitude KG or IG. And (by Cor. 10, Prop. XXXVI) if the breadth of the vessel be infinite, so that the lineola HI may vanish, arid the altitudes IG, HG become equal ; the force of the water that flows down and presses upon the circle will be to the weight of a cylinder whose base is that little circle, and the altitude iIG, as EF 2 to EF 2 |PQ 2 , very nearly. For the force of the water flowing downward uniformly through the whole canal will be the same upon the little circle PQ. in whatsoever part of the canal it be placed. I ,et now the orifices of the canal EF, ST be closed, and let the littk circle ascend in the fluid compressed on every side, and by its ascent let it oblige the water that lies above it to descend through the annular space between the little circle and the sides of the canal. Then will the velocity of the ascending little circle be to the velocity of the descending water as the difference of the circles EF and PQ, is to the circle PQ; and the ve locity of the ascending little circle will be to the sum of the velocities, that is, to the relative velocity of the descending water with which it passes by the little circle in its ascent, as the difference of the circles EF and PQ to the circle EF, or as EF* PQ 2 to EF 2 . Let that relative velocity be equal to the velocity with v/hich it was shewn above that the water would pass through the annular space, if the circle were to remain unmoved, that is, to the velocity which the water would acquire by falling, and in its fall describing the altitude IG ; and the force of the water upon the ascending- circle will be the same as before (by Cor. 5, of the Laws of Motion) ; that is, the resistance of the ascending little circle will be to the weight of a cylinder of water whose base is that little circle, and its altitude iIG, as EF 2 to EF 2 iPQ 2 , nearly. But the velocity of the little circle will be to the velocity which the water acquires by falling, and in its fall de scribing the altitude [G, as EF 2 PQ 2 to EF 2 . "};
samples.machinegun  = {active:false, name:"M240 Machine Gun Manual", text:"Observe all the warnings in this manual. They can save your life. Be sure to clear weapon before disassembling, cleaning, inspecting, transporting, or storing. Ensure that assigned/spare barrels have been headspaced and tagged to your receiver. Rotate usage of the barrels. Do not interchange barrel assembly or bolt assembly from one machine gun to another without being headspaced/gaged. Doing so may result in injury to, or death of, personnel. Never reload a runaway weapon until it is repaired. Be sure weapon is cleared before removing it from vehicle/tripod mount. Before firing, make sure the barrel is locked tightly in the receiver. If the barrel is not locked, threads in receiver could be damaged or cause personal injury. A hot barrel can burn you. If the barrel is hot, use your heat resistant mitten. Using gasoline, kerosene, hydraulic oil, benzene, bensol, high-pressure water, steam, or air for cleaning is prohibited. If nothing is ejected and you have a hot gun (200 rounds fired within a 2 minute period), do NOT open the cover. Place safety to \"S\" safe, keep weapon pointed down range, and remain away from the weapon for 1 5 minutes. After 1 5 minutes, clear your weapon (WP 001 00). The climate temperature in different regions will make a difference as to what constitutes a hot gun. A hot, sunny day can cause a cook-off within 50 rounds, weapon and ammunition in the sun. If runaway occurs, always keep machine gun pointed down range. Always keep weapon pointed down range. Appropriate eye protection is recommended when cleaning your weapon and/or its parts. Use care when removing excess carbon, carbon may chip off and fly into eyes. Cleaning solvent is FLAMMABLE and TOXIC and must be kept away from open flames and used in a well-ventilated area. Use of rubber gloves is necessary to protect the skin when washing machine gun parts. The canvas cover above the driver and passenger seats should always be in place when firing. Firing on the move is not permitted from the M998 HMMWV (Cargo/Troop Carrier). Ground personnel should not be within 1 meters of any vehicle when firing. All personnel within 20 meters of a weapon firing, shall wear approved single hearing protection devices during training exercises. This is the only ammunition authorized for use in your machine gun. If it is not shown, it is not authorized. Ammunition which fails to fire will be disposed of by authorized procedures. Stay clear of muzzle. Do not allow round to hit any hard surface or it may fire. Dispose of live round(s) in accordance with local procedures. First aid For further information on first aid, see FM 21 -1 1 . "};
samples.sutra       = {active:false, name:"Kama Sutra",              text:"ALL the places that can be kissed, are also the places that can be bitten, except the upper lip, the interior of the mouth, and the eyes. The qualities of good teeth are as follows: They shou 1 d be equal, possessed of a pleasing brightness, capable of being colored, of proper proportions, unbroken, and with sharp ends. The defects of teeth on the other hand are, that they are blunt, protruding from the gums, rough, soft, large, and loosely set. The following are the different kinds of biting;The hidden bite. The swollen bite. The point. The line of points. The coral and the jewel. The line of jewels. The broken cloud. The biting of the boar. (1) The biting which is shown only by the excessive redness of the skin that is bitten, is called the \"hidden bite.\" (2) When the skin is pressed down on both sides, it is called the \"swollen bite/' (3) When a small portion of the skin is bitten with two teeth only, it is called the \"point.\" (4) When such small portions of the skin are bitten with all the teeth, it is called the \"line of points.\" (5) The biting which is done by bringing together the teeth and the lips, is called the \"coral and the jewel.\" The lip is the coral, and the teeth the jewel. (6) When biting is done with all the teeth, it is called the \"line of jewels.\" (7) The biting which consists of unequal risings in a circle, and which comes from the space between the teeth, is called the \"broken cloud.\" This is impressed on the breasts. (8) The biting which consists of many broad rows of marks near to one another, and with red intervals, is calk the \"biting of a boar.\" This is impressed on the breasts an the shoulders; and these two last modes of biting are peculk to persons of intense passion. The lower lip is the place on which the \"hidden bite,\" th \"swollen bite,\" and the \"point\" are made; again the \"swolle bite,\" and the \"coral and the jewel\" bite are done on th cheek. Kissing, pressing with the nails, and biting are th ornaments of the left cheek, and when the word cheek i used, it is to be understood as the left cheek. Both the \"line of points\" and the \"line of jewels\" are tc be impressed on the throat, the arm pit, and the joints of the thighs; but the \"line of points\" alone is to be impressed on the forehead and the thighs. The marking with the nails, and the biting of the fol- lowing things, viz., an ornament of the forehead, an ear ornament, a bunch of flowers, a betel leaf, or a tamala leaf, which are worn by, or belong to the woman that is beloved, are signs of the desire of enjoyment. Here end the different kinds of biting."};
samples.malleus     = {active:false, name:"Malleus Maleficarum",     text:"But if, after keeping the accused in suspense, and after due and decent postponements of the time, and many exhortations of the accused, the Bishop and the Judge are well persuaded that, all circumstances considered, the accused is denying the truth, let them torture him slightly, without shedding blood, bearing in mind that torture is often fallacious and ineffective. For some are so soft-hearted and feeble-minded that at the least torture they will confess anything, whether it be true or not. Others are so stubborn that, however much they are tortured, the truth is not to be had from them. There are others who, having been tortured before, are the better able to endure it a second time, since their arms have been accomodated to the stretchings and twistings involved; whereas the effect on others is to make them weaker, so that they can the less easily endure torture. Others are bewitched, and make use of the fact in their torture, so that they will die before the will confess anything; for they become, as it were, insensible to pain. Therefore there is need for much prudence in the matter of torture, and the greatest attention is to be given to the condition of the person who is to be tortured. When, then, the sentence has been pronounced, the officers shall without delay prepare to torture the accused. And while they are making their preparations, the Bishop or Judge shall use his own persuasions and those of other honest men zealous for the faith to induce the accused to confess the truth freely, if necessary promising to spare his life, as we have shown above. But if the accused cannot thus be terrified into telling the truth, a second or third day may be appointed for the continuation of the torture; but it must not be repeated then and there. For such a repetition is not permissible unless some further indications against the accused should transpire. But there is nothing to prevent a continuation of the torture on another day.  Let it be said: We N. Bishop and N. Judge (if he is present) aforesaid, assign to you N. such a day for the continuation of the torture, that the truth may be known from your own mouth. And let all be set down in the process. And during the interval appointed to him, let them use their own persuasions and those of other honest men to induce him to confess the truth. But if he has refused to confess, the torture can be continued on the day assigned, more or less severely according to the gravity of the offences in question. And the Judges will be able to observe many lawful precautions, both in word and deed, by which they may come at the truth; but these are more easily learned by use and experience and the variety of different cases than by the art of teaching of anyone."};

function blendSamples()
{
   var txt = [], flag = false;
   for(var i in samples)
      if(samples[i].active){
         txt.push(samples[i].text);
         flag = true;
      }

   txt.shuffle();
   inputText = txt.join(" ");
   return flag;
}

function doMarkov()
{
   // Make the string contain two copies of the input text.
   // This allows for wrapping to the beginning when the end is reached.
   var str = inputText + " ";
   var nchars = str.length;
   str = str + str;

   var lev = parseInt(document.getElementById("slider").value);
   var strBuilder = [];

   // Pick a random starting character, preferably an uppercase letter.
   var ichar, chr, imatch, nmatches;
   for (i = 0; i < 1000; i++) {
   	ichar = Math.floor(nchars * Math.random());
   	chr = str.charAt(ichar);
   	if ((chr >= "A") && (chr <= "Z")) break;
   }

   // Write starting characters.
   strBuilder = str.substring(ichar, ichar + lev).split("");

   // Set target string.
   var target = str.substring(ichar + 1, ichar + lev);

   // Generate characters.
   // Algorithm: Letter-based Markov text generator.
   for (i = 0; i < 1000; i++) {
   	if (lev == 1) {
   		// Pick a random character.
   		chr = str.charAt(Math.floor(nchars * Math.random()));
   	} 
   	else {
   		// Find all sets of matching target characters.
   		nmatches = 0
   		j = -1
   		while (true) {
      		j = str.indexOf(target, j + 1)
      		if ((j < 0) || (j >= nchars)) {
      			break
      		}
            else {
      			nmatches++
      		}
   	  }

			// Pick a match at random.
			imatch = Math.floor(nmatches * Math.random())

			// Find the character following the matching characters.
			nmatches = 0
			j = -1
			while (true) {
				j = str.indexOf(target, j + 1)
				if ((j < 0) || (j >= nchars)) {
					break
				}
            else if (imatch == nmatches) {
					chr = str.charAt(j + lev - 1)
					break
				} 
            else {
					nmatches++
   			}
   		}
   	}

   	 strBuilder.push(chr);

   	 // Update the target.
   	if (lev > 1) {
   		target = target.substring(1, lev - 1) + chr;
   	}
   }

   outputText = strBuilder.join("");
   return outputText;
}

window.onload = function(){
   for(var i in samples){
      var x = document.createElement("input");
      var y = document.createElement("div");
      x.setAttribute("type", "checkbox");
      x.setAttribute("id", i);
      x.setAttribute("class", "checkbox");
      x.setAttribute("onChange", "check("+ i + ")");

      y.appendChild(x);
      y.setAttribute("class", "checkboxdiv");
      y.innerHTML += samples[i].name;
      document.getElementById("boxes").appendChild(y);
   }
}

function check(x){
   samples[x.id].active = x.checked;
}

function runFunc(){
   inputText = "";
   if(!blendSamples()){
      alert("Please choose at least one text!");
      return;
   }
   doMarkov();
   document.getElementById("outputarea").value = outputText;
}

Array.prototype.shuffle = function(){
    for(var j, x, i = this.length; i; j = Math.floor(Math.random() * i), x = this[--i], this[i] = this[j], this[j] = x);
};